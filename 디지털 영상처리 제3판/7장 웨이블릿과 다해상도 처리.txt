[7. 웨이블릿과 다해상도 처리]
[7.1 배경]
[7.1.1 영상 피라미드]
다해상도로 영상을 표현하는, 강력하지만 개념적으로 단순한 구조는 영상 피라미드이다.
비전과 영상 압축 응용을 위해 고안된 것으로, 피라미드 모양으로 배열된 해상도가 감소하는 영상의 모임이다.
피라미드의 바닥은 처리될 영상의 고해상도 표현을 갖고 있고, 꼭대기는 저해상도 근사화를 갖고 있다. 피라미드를 올라갈수록 크기와 해상도 모두 감소한다.
근사화 피라미드들과 달리, 예측 오차 피라미드들은 입력 영상의 단 하나의 축소-해상도 근사화를 포함한다. 다른 모든 레벨들은 예측 오차를 갖는다.
레벨 j 예측 오차는 레벨 j 근사화와 레벨 j-1 근사화에 기반한 j 근사화의 추정간의 차이로 정의된다.
근사화 피라미드와 예측 오차 피라미드 모두 반복적인 방식으로 계산된다.
(단계 1) 레벨 j 입력 영상의 축소-해상도 근사화를 계산한다. 이는 필터링한 후 그 결과를 두 배로 다운샘플링하여 수행된다. 결과 근사화를 근사화 피라미드 레벨 j-1에 놓는다.
(단계 2) (단계 1)에서 만든 축소-해상도 근사화로부터 레벨 j입력 영상의 추정을 만든다. 이는 업샘플링한 후, 생성된 근사화를 필터링하여 수행된다. 예측 영상은 레벨 j입력 영상과 같은 크기를 가질 것이다.
(단계 3) (단계 2)의 예측 영상과 (단계 1)의 입력 영상 간의 차이를 계산한다. 이 결과를 예측 오차 피라미드의 레벨 j에 놓는다.
예측 오차 피라미드가 필요하지 않다면, 업샘플링, 보간 필터, 합산기 연산과 함께 생략될 수 있다.
필터링은 공간 영역에서 수행된다. 유용한 근사화 필터링 기법들에는 평균 피라미드를 만드는 이웃 평균화, Gauss 피라미드를 만드는 저역통과 Gauss 필터링, 그리고 서브샘플링 피라미드가 되는 필터링 없는 경우가 포함된다.
최근접 이웃, 쌍일차, 쌍삼차를 포함하는 보간법들 모두 보간 필터에 사용될 수 있다.
업/다운샘플링은 계산된 근사화 영상과 예측 영상의 공간 크를 두 배 또는 반으로 만드는 데 사용된다.
업샘플링은 시퀀스 각 샘플 다음에 0을 삽입하는 것으로, 다운샘플링은 격번째 샘플들을 버리는 것으로 본다.
피라미드의 낮은 해상도 레벨들은 큰 구조나 영상 전체 양상을 해석하는 데 사용되고, 고해상도 영상들은 각 객체의 특성을 해석하는 데 적당하다. 이를 거칠음-디테일 해석 전략이라 하고, 패턴인식에서 유용한 전략이다.
예측 오차 영상은 더 오차확률이 높은 값들에 더 적은 비트를 할당함으로써 크게 압축될 수 있다.
[7.1.2 부대역 코딩]
다해상도 해석에 버금가는 중요한 영상화 기술은 부대역 코딩이다.
부대역 코딩에서 영상은 부대역으로 불리는 대역 제한된 성분들의 집합으로 분해된다.
분해는 원래 영상을 오차 없이 재구성하기 위해 부대역들이 재조립될 수 있도록 수행된다.
분해와 재구성이 디지털 필터에 의해 수행되어서, 디지털 신호 처리(DSP)와 디지털 신호 필터링을 알아야 한다.
간단한 디지털 필터는 단위 지연, 곱셈기, 덧셈기의 세 가지 기본 요소들로 구성된다.
K개의 곱셈 상수들은 필터 계수라 불리고, 각 계수는 한 개의 필터 탭(tap)을 정의한다.
필터 탭은 합산의 한 항을 계산하는 데 필요한 요소로 간주될 수 있고, 이 필터의 차수를 K차수라고 한다.
임펄스 응답은 필터를 정의하는 필터 계수들로 구성된 K-요소 시퀀스이다.
물리적으로, 단위 임펄스는 필터의 상단의 왼쪽에서 오른쪽으로 가로질러 쉬프트되어, 지연된 임펄스의 위치에서의 계수의 값을 취하는 출력을 만든다.
K개의 계수가 있기 때문에, 임펄스 응답은 길이가 K이며, 이 필터를 유한 임펄스 응답 필터라 부른다.
부호 반전, 순서 역전, 변조가 때때로 두 필터 간의 관계를 규정할 때 사용된다.
필터 뱅크는 둘 이상의 필터들의 모음이다.
분석 필터 뱅크는 입력 시퀀스를 입력을 나타내는 두 개의 절반 길이 시퀀스로 나누기 위해 사용된다.
저역통과 필터는 근사화, 고역(고주파)통과 필터는 디테일 부분을 나타낸다.
부대역 코딩 및 디코딩 시스템의 입력과 출력이 동일하도록 만드는 것이 목표이며, 이것이 달성되었을 때, 그 시스템이 완전 재구성 필터를 사용한다고 말한다.
완전 재구성 필터 뱅크를 위해서는 직교정규성을 만족해야 한다.
직교정규 필터 뱅크는 프로토타입이라 불리는 단일 필터의 임펄스 응답 부근에서 생성된 수 있고, 나머지 필터들은 규정된 프로토타입의 임펄스 응답으로부터 계산될 수 있다.
1-D 직교정규 및 쌍직교 필터들은 영상 처리를 위한 분리 가능한 2-D 필터로 사용될 수 있다.
이 경우, 각 차원에 차례대로 필터가 적용되며, 다운샘플링이 두 단계로 수행된다. 처음에 필터링된 출력들을 각각 입력 영상의 근사화, 수직 디테일, 수평 디테일, 대각 디테일 부대역이라 한다.
근사화 부대역을 제외하고, 나머지 부대역들은 구조들이 잘 보이도록 스케일링 된다.
원래 영상은 부대역들로부터 오차 없이 재구성될 수 있다.
[7.1.3 Haar 변환]
가장 오래되고 간단한 직교정규 웨이블릿이다.
T=HFH^(-1)로 표현되며 F는 N*N 영상 매트릭스, H는 N*N 변환 매트릭스, H가 대칭이 아니기에 대칭성을 위해 필요한 전치 매트릭스와 T는 결과인 N*N 변환이다.

[7.2 다해상도 전개]
앞에서 다해상도 분석(MRA)이라 불리는 수학적 구조에서 중요한 역할을 하는 세 가지 영상화 기법을 알아봤다.
스케일링 함수는 각각이 최근접 이웃 근사화와 해상도에서 2의 비율로 다른 일련의 함수 또는 영상의 근사화를 만들기 위해 사용된다.
웨이블릿이라 불리는 부가 함수들은 인접 근사화들 간의 정보 차이를 인코딩하기 위해 사용된다.
[7.2.1 급수 전개]
전개 함수들의 선형 결합으로 더 잘 분석될 수 있다.
[7.2.2 스케일링 함수들]
다해상도 분석의 네 가지 기본 요건
(요건 1) 스케일링 함수는 그 정수 이동에 대해 직교이다. Haar 함수가 1의 값을 가질 때는 항상 그 정수 이동이 0이라서 둘의 곱이 0이다. 이를 Haar 스케일링 함수가 컴팩트 서포트를 갖는다고 말한다.
서포트라 불리는 유한 구간 밖에서는 어디서든 0이라는 의미이다.
(요건 2) 낮은 스케일에서 스케일링 함수에 의해 스팬되는 부공간은 높은 스케일에서 스팬된 것 안에 내포된다.
고해상도 함수들을 포함하는 부공간은 모든 더 낮은 해상도 함수들도 포함해야 한다.
(요건 3) 모든 V_j(부공간)에 대해 공통인 유일한 함수는 f(x)=0이다.
가장 넓은(coarse) 가능한 전개 함수들을 고려하면, 유일하게 표현 가능한 함수는 정보가 없는 함수이다.
(요건 4) 모든 함수는 임의의 정확도로 표현될 수 있다.
거친 해상도의 특정 f(x)를 전개하는 것은 가능하지 않을 수 있지만, 모든 측정 가능하고, 제곱-적분 가능한 함수들은 j→∞인 한계에서 스케일링 함수로 표현할 수 있다.
이러한 조건 하에 부공간 V_j의 전개 함수들은 부공간 V_j+1의 전개 함수들의 가중 합으로 표현될 수 있다.
임의의 부공간의 전개 함수들은 자신의 2배 해상도 복사로부터, 즉 바로 다음 더 높은 해상도 공간의 전개 함수들로부터 구축될 수 있다는 것을 의미한다. 기준 부공간 V_0의 선택은 임의적이다.
[7.2.3 웨이블릿 함수들]
MRA(다해상도 분석) 요건을 만족하는 스케일링 함수가 주어지면, 그의 정수 이동과 이진 스케일링들과 함께, 두 인접 스케일링 부공간 간의 차이를 스팬하는 웨이블릿 함수를 정의할 수 있다.
스케일링 함수를 이용한 근사화와 실제 함수 간의 차이를 웨이블릿들이 인코딩한다.
웨이블릿 공간들은 그 다음 고해상도 스케일링 함수들에 의해 스팬되는 공간안에 있으므로, 해당 스케일링 함수 상대와 같이 모든 웨이블릿 함수는 쉬프트된 2배 해상도 스케일링 함수들의 가중 합으로 표현될 수 있다.

[7.3 1차원 웨이블릿 변환]
[7.3.1 웨이블릿 급수 전개]
웨이블릿과 스케일링 함수에 관한 함수의 웨이블릿 전개는 f(x)의 부공간의 스케일링 함수 전개와 부공간의 어떤 수의 웨이블릿 함수 전개들로 표현될 수 있다.
전개가 원래 함수를 닮기 시작한다는 것은, 더 높은 스케일들이 추가될 수록 근사화는 함수를 더 정확히 표현되기 때문이다. j→∞인 한계에서 원래 함수가 된다.
[7.3.2 이산 웨이블릿 변환]
Fourier 급수 전개와 같이, 웨이블릿 급수 전개는 연속 변수 함수를 일련의 계수로 매핑한다.
전개된 함수가 이산인 경우(일련의 수인 경우), 그 결과 계수들을 이산 웨이블릿 변환(DWT)이라 부른다.
순방향 DWT 계수와 역 DWT가 존재한다.
Haar 웨이블릿들에 대해, 변환에 채택된 이산화된 스케일링 및 웨이블릿 함수들(기저 함수들)은 M*M Haar 변환 매트릭스의 행들에 해당한다.
변환 그 자체는 M개의 계수들로 구정되고, 최소 스케일링은 0이고, 최대 스케일링은 J-1이다.
[7.3.3 연속 웨이블릿 변환]
이산 웨이블릿 변환의 자연스러운 확장은 연속 웨이블릿 변환(CWT)이다. 이는 연속 함수를 두 연속 변수인 이동과 스케일의 고도로 중복적인 함수로 변환한다.
결과 변환은 이해하기 쉽고 시간-주파수 분석에 유용하다.
대표적인 예시로 멕시코 모자 웨이블릿이 있다. 이는 특이한 모양을 가지고 있고 Gauss 확률 함수의 2차 미분에 비례하고, 평균값이 0이며, 컴팩트하게 지원된다.
연속적이고 가역적 변환이 존재하기 위한 수용성 요건을 만족시키지만, 관련 스케일링 함수가 없고, 계산된 변환은 직교 분석을 할 수 없다.
가장 두드러진 특징은 대칭성과 명시적 표현이 존재한다는 점이다.
공간과 주파수 정보 둘 다 제공한다. f(x)와 그가 계산된 웨이블릿 간의 유사성에 대한 객관적 척도를 제공하기 때문에, 특징 검출에 어떻게 사용될 지 쉽게 알 수 있다.
관심 특징들과 일치하는 웨이블릿들을 필요로 할 때, 변환의 절대값을 흑색과 흰색 사이의 밝기의 표현한 밝기 그래프에서 비슷한 관측을 끌어낼 수 있다.
연속 웨이블릿 변환이 1-D 함수를 2-D 결과로 변환시킨다.