[5.1 영상 열화/복원 과정 모델]
열화(오염)된 영상을 열화 함수에 대한 어떤 지식, 부가 노이즈 항에 대한 어떤 지식이 주어졌을 때, 원래 영상의 추정을 얻는 것이 목표이다.
가능한 원래 입력 영상에 추정이 가까워져야 하므로, 일반적으로 열화 함수와 부가 노이즈 항에 대해 많이 알 수록 더 가까워 지기에 많이 알아야 한다.

[5.2 노이즈 모델들]
디지털 영상의 노이즈는 영상 획득과 전송을 하는 동안 주로 발생한다.
영상 전송 시에는, 전송에 사용되는 채널의 혼선에 의해 주로 오염된다.
[5.2.1 노이즈의 공간 및 주파수 특성]
주파수 성질은 푸리에 감각(전자기 스펙트럼의 주파수들과 반대)으로 노이즈의 주파수들을 알려준다.
노이즈의 푸리에 스펙트럼이 상수일 때, 그 노이즈를 백색 노이즈라 부른다. 이 용어는 같은 성질의 가시 스펙트럼에서 거의 모든 주파수들을 동등한 비율로 갖고 있는 백생광의 물리적 성질에서 유례됐다.
즉, 같은 비율로 모든 주파수를 갖는 함수에 대한 푸리에 스펙트럼은 상수다.
[5.2.2 몇 가지 중요한 노이즈 확률 밀도 함수]
Gauss 노이즈 모델은 공간 및 주파수 도메인 모두에서 수학적으로 다루기 쉽기에 자주 사용된다.
노이즈에 대한 정보가 하나도 없다면 보통 Gauss 노이즈로 가정한다.
전자 회로 노이즈와 낮은 조명 또는 높은 온도로 인한 센서 노이즈와 같은 요인들로 인해 영상에 발생한다.
Rayleigh 노이즈의 밀도는 휘어진 히스토그램을 근사화하는 데 매우 유용하다.
Rayleigh 밀도는 거리 영상화의 노이즈 현상을 특징짓는 데 유용하다.
Erlang 노이즈는 흔히 감마 밀도라 부르는데, 특정 상황에서만 유효해서 Erlang 밀도라 부르는게 적합하다.
지수 노이즈는 Erlang 확률밀도분포의 특별한 경우이다.
지수와 감마(또는 Erlang) 밀도들은 레이저 영상화에 응용된다.
균일 노이즈 균일한 형태의 노이즈이다.
균일 밀도는 시뮬레이션에 사용되는 많은 랜덤 수 생성기의 기초이다.
임펄스(소금-후추) 노이즈는 어두운 점과 밝은 점이 나타는 노이즈로, 단극(unipolar)이라고 불린다.
데이터 빠짐(data-drop-out)과 스파이크(spike) 노이즈 또한 이 형태의 노이즈를 가리키는 용어들이다.
노이즈 임펄스는 음 또는 양이 될 수 있다. 스케일링은 보통 영상 디지털화 과정의 일부분이다. 임펄스 오염이 대개 영상 신호의 세기에 비해 크기 때문에, 영상에서 극값(완전 검은색 or 흰색)으로 디지털화 된다. 이러한 값들은 영상에서 혀용된 최대/최소값과 같다하여, "포화된" 값이라고 가정한다.
음의 임펄스는 검은(후추) 노이즈(점), 양의 임펄스는 흰(소금) 노이즈(점)로 보인다.
영상화 동안 부적절한 스위칭과 같은 빠른 과도상태가 일어날 때 나타난다.
[5.2.3 주기적 노이즈]
일반적으로 영상 획득 동안의 전기 또는 전기기계적 간섭에 의해 발생한다. 이는 유일한 공간 종속적 노이즈 유형이다. 주기적 노이즈는 주파수 도메인 필터링을 통해 구별하기 쉽기 때문에 주파수 필터링으로 상당히 감쇠시킬 수 있다.
[5.2.4 노이즈 파라미터 추정]
주기 노이즈의 파라미터는 일반적으로 영상의 푸리에 스펙트럼을 관찰하여 추정한다. 주기 노이즈는 시각적 분석에 의해서도 흔히 검출할 수 있는 수파수 스파이크를 만드는 경향이 있다.
자동 분석은 노이즈 스파이크가 예외적으로 현저하거나 간섭 주파수 성분들에 대한 대체적인 위치에 대해 할 수 있는 경우에 가능하다.
노이즈 확률밀도함수(PDF)의 파라미터들은 센서의 사양으로부터 부분적으로 할 수도 있지만, 대개 특정 영상화 장치에 대해 추정할 필요가 있다.
영상화 시스템으로, 시스템 노이즈 특성을 알아보는 간단한 방법은 "단색"환경에 대해 일련의 영상을 촬영하는 것이다.
센서에 의해 이미 생성된 영상만 주어지는 경우, 종종 적당히 일정한 배경 밝기를 갖는 작은 조각들로부터 PDF의 파라미터를 주정하는 것이 가능하다.
그림의 히스토그램과 노이즈 PDF의 모양이 흡사하다면 해당 노이즈임을 알 수 있다.
해당 노이즈에 필요한 값은 노이즈마다 다르다 예를 들어 Gauss 노이즈는 평균과 분산 두 파라미터에 의해 완전히 기술되므로, 이 두 값이 필요한 전부이다.

[5.3 노이즈만 있을 때의 복원-공간 필터링]
공간 필터링은 랜덤한 부가 노이즈만 존재할 때 선택하는 방법이다.
[5.3.1 평균 필터]
산술 평균 필터는 평균 필터들 중 가장 간단한 필터다.
중심이 (x, y)에 있고 크기가 m*n인 사각형으로 된 부영상 윈도우(이웃)에 대한 좌표들의 집합을 S_xy라면, 산술 평균 필터는 S_xy로 정의되는 영역에서 오염된 영상의 평균값을 계산한다. 복원된 영상의 값은 S_xy로 정의되는 영역 화소들에 대해 게산된 단순 산술 평균이다. 이 연산은 모든 계수들이 1/mn 값을 갖는 m*n 크기의 공간 필터로 구현될 수 있다. 지역적 변화를 스무딩하고, 블러링의 결과로 노이즈가 감쇠된다.
기하 평균 필터로 복원된 화소는 이웃의 화소들을 곱하고 (1/mn)승한 것이다. 산술 평균 필터와 비슷한 스무딩 결과를 얻지만, 영상의 디테일을 덜 잃는 경향이 있다.
하모닉 평균 필터는 소금 노이즈에 대해 잘 동작하지만, 후추 노이즈에 대해서는 좋은 결과를 얻지 못한다. Gauss 노이즈와 같은 기타 노이즈 유형에 대해서도 잘 동작한다.
콘트라하모닉 평균 필터는 소금-후추 노이즈 효과를 감소시키거나 거의 제거하는 데 적당하다. 그러나 양(후추, 검은 점)이나 음(소금, 흰 점)을 동시에 제거할 수는 없다. 공식에서 Q=0이면 산술 평균 필터, Q=-1이면 하모닉 평균 필터가 된다.
일반적으로 산술 및 기하 평균 필터들(특히 후자)은 Gauss 노이즈 또는 균일 노이즈와 같은 랜덤 노이즈에 대해 적합하다. 콘트라하모닉 평균 필터는 임펄스 노이즈에 적합하지만 노이즈가 어두운지 밝은지를 알아야 하는 단점이 있다.
[5.3.2 순서-통계 필터]
순서-통계 필터는 응답이 필터로 커버되는 영상 영역의 화소 값들을 정렬하는 것에 기반하는 공간 필터이다. 정렬의 결과로 필터의 응답이 결정된다.
중간값 필터는 가장 잘 알려진 순서-통계 필터이다. 이는 한 화소를 해당 화소를 포함한 이웃들과의 밝기 레벨의 중간값으로 해당 화소값을 대체한다. 특정 형태의 랜덤 노이즈에 대해서 비슷한 크기의 선형 스무딩 필터보다 적은 블러링으로 노이즈 축소 능력을 제공하므로 상당히 많이 사용된다. 양극과 단극 임펄스 노이즈 모두 존재하는 경우 특히 효과적이다.
최대 필터와 최소 필터는 중간값 필터가 정렬된 집합에서 50번째 백분율을 나타내지만 100번째를 사용하면 최대, 0번째를 사용하면 최소 필터가 된다. 최대 필터는 영상의 가장 밝은 점들을 찾는데 유용하며 후추 노이즈가 감소된다. 최소 필터는 가장 어두운 점들을 찾는 데 유용하며, 소금 노이즈를 감소시킨다.
중간점 필터는 최대값과 최소값 사이의 중간점을 계산한다. 순서 통계와 평균을 조합한 필터로, Gauss 노이즈 또는 균일 노이즈와 같이 랜덤하게 분포된 노이즈에 대해 가장 잘 동작한다.
Alpha-트리밍 평균 필터는 이웃에 있는 d/2가의 가장 낮은 밝기 값들과 d/2개의 가장 높은 밝기 값들을 제거하고, 나머지 화소들에 대한 평균값을 구하는 필터다. d는 0 <= d <= mn-1의 범위를 가지며, d=0인 경우 산술 평균 필터가 되고, d=mn-1인 경우 중간값 필터가 된다. 그 외의 d값의 경우 소금-후추 노이즈와 Gauss 노이즈가 조합된 경우 같은 다중 형태의 노이즈에 대해 유용하다.
필터를 중복 적용해서 노이즈를 계속 감쇠시킬 수 있지만, 적용할 수록 영상이 흐려지므로 반복 적용 횟수를 가능한 적게 하는 것이 좋다.
[5.3.3 적응 필터]
앞선 필터들은 한 번 정해지면 위치에 따하 영상 특성이 변하는 것과 관계없이 적용된다. 다음은 m*n 직각사각형 윈도우 S_xy로 정의되는 필터 영역 내의 영상의 통계적 특성에 기반하여 작용이 변하는 두 개의 적응 필터에 대해 적혀있다.
적응 필터는 앞선 필터들 보다 뛰어난 성능을 가진다. 성능이 향상된 대신 필터의 복잡도가 높아진다.
먼저, 적응적/지역적 노이즈 감소 필터를 알아보자. 랜덤 변수의 가장 단산훈 통계 척도는 평균과 분산이다. 이는 영상의 모양과 밀접하게 관련되어 있는 수량이므로 적응 필터가 기반하기에 합당한 파라미터들이다. 평균과 분산은 계산할 영역에서 각각 평균 밝기와 콘트라스트의 척도이다.
알거나 추정해야 할 수량은 전체 노이즈의 분산 뿐이고, 다른 파라미터들은 윈도우의 중심인 (x, y)에서 S_xy에 속하는 화소들로부터 계산된다. 
과정에 검사가 표함되면 필터는 비선형이 되며, 이는 영상 노이즈의 분산에 대한 지식이 부족하기 때문에 터무니없는 경과가 나오지 않도록 예방해주는 효과가 있다. 
다른 접근으로 음의 값을 허용한 후 최종적으로 밝기 값을 다시 스케일링 하는 방법이 있다. 그 결과로 영상의 동적 범위를 줄어들게 만든다.
필터에 사용되는 분산이 영상보다 너무 낮은 추정 값을 사용하는 경우, 영상은 필요한 것 보다 조금 수정되므로 알고리즘은 원 영상과 많이 닮은 영상을 반환한다. 너무 큰 추정치는 분산의 비를 1.0에서 잘리게 하여, 정상적일 때보다 영상에서 평균을 더 자주 감산할 것이다.
음의 값이 허용되고 영상이 마지막에 다시 스케일링된다면, 동적 범위에서 손실이 발생한다.
다음으로 적응적 중간값 필터가 있다. 기존 중간값 필터는 임펄스 노이즈의 공간 밀도가 크지 않을 때만 사용할 수 있었기에, 적응적 중간값 필터는 중간값 필터보다 더 큰 확률을 갖는 임펄스 노이즈를 다룰 수 있다.
적응적 중간값 필터링의 또 다른 장점은 비임펄스 노이즈를 스무딩하는 동안 디테일을 보존한다. 기존 중간값 필터는 하지 못하는 것이다.
적응적 중간값 필터도 직각사각형 윈도우 영역에서 작동한다. 그러나 필터 연산 동안 특정 조건들에 따라 윈도우의 크기를 바꾼다(증가시킨다). 이 필터의 출력은 주어진 시간에 윈도우의 중심이 놓이는 점인 (x, y)의 화소값을 대체하는데 사용되는 단일 값이다.
주요 목적으로는 소금-후추(임펄스) 노이즈 제거, 임펄스가 아닌 다른 노이즈의 스무딩, 객체 경계의 과도한 세선화 또는 후선화 같은 왜곡을 줄이는 것이다.
임펄스 밀도가 증가하면 노이즈 스파이크를 제거하기 위해 더 큰 윈도우가 필요하다. 윈도우 허용 최대 크기(S_max)는 기존 중간값 필터의 필터 사이즈와 동일한 개념이다.
윈도우가 다음 위치로 이동할 때마다, 알고리즘을 초기화하고 중간값을 새로운 화소들로만 사용해서 반복적으로 갱신하면 계산 부담을 줄일 수 있다.

[5.4 주파수 도메인 필터링에 의한 주기 노이즈 감소]
주기적 노이즈는 주파수 도메인 기법으로 효과적으로 분석 및 필터링할 수 있다.
기본 아이디어는 주기 노이즈가 푸리에 변환에서 주기적 간섭의 주파수에 해당하는 위치에서 밀집된 에너지 폭발로 나타난다는 것이다. 이는 노이즈를 분리하는 선택적 필터를 사용한 것이다.
[5.4.1 대역차단 필터]
대역 차단 필터는 특정한 주파수 영역을 차단하는 필터링 방법이다.
주요 응용 중 하나는 주파수 도메인에서의 노이즈 성분의 전반적 위치가 알려진 응용에서의 노이즈 제거이다.
대표적인 예시로 2차원 정현파 함수로 근사화할 수 있는 부가적인 주기 노이즈로 오염된 영상이 있다.
이는 sin의 푸리에 변환이 변환 도메인의 원점에 대해 서로 거울 대칭인 두 개의 임펄스로 나타난다는 것을 볼 수 있다. 여기서, 대칭인 모양이 원이라면 원형 대칭 대역차단 필터가 좋은 선택이다.
4차 Butterworth 대역차단 필터는 원 모양을 가지고 있으므로 위와 같은 상황에서 좋은 선택이다.
변환으로부터 가능한 적게 제거하는 것이 바람직하기 때문에, 대역차단 필터는 날카롭고 좁은 필터를 사용하는 것이 보편적이다.
[5.4.2 대역통과 필터]
대역통과 필터는 대역차단 필터의 반대 연산을 수행한다. 즉, 특정 주파수 영역만을 통과시킨다.
대역통과 필터링은 일반적으로 영상의 디테일을 너무 많이 제거해서 일반적인 방법은 아니다.
이는 주파수 대역들에 의해 야기된 영상에 대한 효과(Ex. 주기적 노이즈)들을 분리하는 데 매우 유용하다.
이 방법으로 오염된 영상에서 노이즈를 복원시킨다면 이는 영상을 오염시킨 노이즈와 매우 유사하다.
다시 말해, 대역통과 필터링은 노이즈 패턴을 분리 및 분석에 도움을 준다.
[5.4.3 노치 필터]
중심 주파수 근처의 미리 정의된 이웃의 주파수들을 차단(또는 통과)시킨다.
푸리에 변환의 대칭성 때문에, 노치 필터가 의미있는 결과를 얻기 위해서는 원점에 대해 대칭 쌍으로 나타나야 한다. 한 가지 예외는 노치 필터가 원점에 위치하는 경우로, 그 자신으로 나타낸다.
구현될 수 있는 노치 필터 쌍의 수는 임의적이다. 또한 노치 영역도 임의적이다. (Ex. 직사각형)
노치 필터링은 (푸리에 변환을 통한 주파수 스펙트럼 모양에 맞는) 적당한 필터를 찾을 수만 있다면 선호되는 방법이다.
[5.4.4 최적 노치 필터링]
최적이란 노치 필터링을 통해 복원된 영상의 지역적 분산을 최소화시킨다는 의미이다.
두 개 이상의 간섭 성분들이 존재하는 경우, 앞선 방법들은 너무 많은 영상 정보를 제거할 수 있다.
또한, 간섭 성분들은 일반적으로 단일 주파수 폭발이 아니고, 간섭 성분들이 간섭 패턴에 대한 정보를 수반하는 넓은 자락을 갖는 경향이 있다.
이 자락들은 변환 도메인의 배경으로부터 쉽게 검출되는 것은 아니다. 이들은 열화 감소시키는 효과를 가진 대안적 필터링 방법들이 여러 응용들에서 유용하다.
지역적 분산을 최소화 시키기 위해서 간섭 패턴의 주요 수파수 성분들을 분리한 후, 오염된 영상으로부터 그 패턴의 가변적이고 가중된 비율을 뺀다.

[5.5 선형, 위치-불변 열화]
모든 f(x, y)에 대해, 입출력 관계 g(x, y) = H[f(x, y)]를 만족하면 위치 또는 공간 불변적이라고 한다.
광학에서 임펄스는 점광이 되며, 일반적으로 점 확산 함수(PSF)라 부른다. 이는 모든 물리 광학 시스템이 광학 부품들의 품질에 의한 블러링 양에 따라 정도를 달리하여 점광을 흐리게 한다는 사실에서 유례한다.
선형 시스템 H는 그의 임펄스 응답에 의해 완전히 특정지어질 수 있다.
제 1종 중첩 적분은 선형 시스템 이론의 핵심에 있는 기초적 결과이다. 여기서 유도된 컨볼루션 적분을 통해 선형 시스템(H)의 임펄스 응답을 알면 임의의 입력에 대한 그의 응답을 계산할 수 있다.
요약하면, 부가 노이즈를 갖는 선형, 공간 불변 열화 시스템은 공간 도메인에서 영상과 열화(점 퍼짐) 함수를 컨볼루션한 후 노이즈를 부가하는 형태로 모델링될 수 있다.
컨볼루션 정리에 의하면, 똑같은 과정이 주파수 도메인에서 영상과 열화에 대한 변환들을 곱한 후 노이즈의 변환을 더하는 형태로 표현될 수 있다.
주파수 도메인에서 작업할 때, FFT 알고리즘을 사용하며, 이산 푸리에 변환의 구현에 함수 패딩이 필요하다.
많은 형태의 열화는 선형, 위치 불변 과정으로 근사화될 수 있다.
이 접근법의 장점은 영상 복원 문제의 해결에 선형 시스템 이론의 광범위 도구들을 사용할 수 있다는 점이다.
비선형 위치-종속 기법이 좀 더 일반적이지만, 알려진 해가 없거나 계산상 매우 풀기 어려운 상황을 만든다.
열화는 컨볼루션의 결과로 모델링되고, 복원은 그 과정을 역으로 적용하는 필터를 찾는 것이므로, 선형 영상 복원을 나타내기 위해 흔히 영상 디컨볼루션(deconvolution)이라는 용어를 사용한다.
비슷하게, 복원 과정에서 사용되는 필터를 흔히 디컨볼루션 필터(deconvolution filter)라 부른다.

[5.6 열화 함수의 추정]
영상 복원에서 열화 함수를 추정하는 세 가지 주요 방법은 (1) 관찰, (2) 실험, (3) 수학적 모델링이다.
어떤 방법으로 추정된 열화 함수를 이용해서 영상을 복원하는 과정을, 블라인드 디컨볼루션이라 부른다. 이는 진짜 열화 함수를 완전히 알기 어렵기 때문이다.
[5.6.1 영상 관찰에 의한 추정]
열화 함수에 대한 어떠한 지식도 없이 열화된 영상이 주어졌다. H를 추정하는 한 방법은 영상 그 자체에서 정보를 얻는 것이다.
예를들어, 영상이 흐려진 경우, 객체와 배경 일부 등 샘플 구조를 포함하는 영상의 작은 직사각형 부분을 살펴볼 수 있다.
역사적 가치가 있는 오래된 사진을 복원하는 것과 같은 매우 특별한 상황에서만 사용되는 노동력이 많이 드는 과정이다.
[5.6.2 실험에 의한 추정]
열화 영상을 얻는 데 사용된 장치와 유사한 장치를 얻을 수 있다면, 열화를 정확히 추정하는 것은 원리적으로 가능하다.
복원 대상과 가능한 가깝게 열화될 때까지 시스템을 설정하여 유사 영상을 얻는다. 
그 후 동일한 시스템 설정을 이용하여 임펄스를 영상화해서 열화에 대한 임펄스 응답을 얻는다. 임펄스는 효과를 무시할만한 값으로 줄이기 위해 가능한 밝은 점과에 의해 시뮬레이션된다.
임펄스의 푸리에 변환은 상수이다.
[5.6.3 모델링에 의한 추정]
열화 모델링은 영상 복원 문제에 접근하는 통찰을 제공하기 때문에 사용되어 왔다. 몇몇의 경우 열화를 일으키는 환경 조건을 고려할 수도 있다.
Gauss LPF는 약하고 균일한 블러링을 모델링하기 위해 종종 사용된다.
모델링의 다른 중요 접근법은 기본 원리들로부터 시작해서 수학적 모델을 유도하는 것이다.

[5.7 역필터링]
열화 함수 H로 열화된 영상의 복원을 탐구하는 것이 첫 번째 단계라면, 복원의 가장 간단한 접근법은 열화된 영상의 변환을 열화 함수로 단순히 나누어 원래 영상의 변환에 대해 추정을 계산하는 직접 역 필터링이 있다.
0 또는 작은값 문제를 극복하는 한 방법은 필터 주파수를 원점 부근의 값들로 제한하는 것이다. 원점 주위의 주파수들로 해석을 제한함으로써 0 값을 만날 확률을 줄이는 것이다.

[5.8 최소 평균 제곱 오차(Wiener) 필터링]
역 필터링 접근법은 노이즈를 다루기 위한 명시적인 도구가 되지 못한다.
열화 함수와 노이즈의 통계적 특성을 모두 복원 과정에 포함시키는 접근법에 대해 논의한다.
이 방법은 영상과 노이즈를 랜덤 변수로 보는 것이 기반하며, 목표는 오염되지 않은 영상과의 평균 제곱 오차가 최소화 되는 추정 영상을 찾는 것이다.
이는 Wiener 필터라는 이름으로 잘 알려져 있으며, 최소 (평균 제곱 or 제곱) 오차 필터라고도 부른다.
Wiener 필터는 열화 함수에서 제로들을 가진 역 필터와 같은 문제를 갖지 않는다.
복원 영상을 주파수 도메인의 추정에 대한 푸리에 역변환으로 주어진다.
노이즈가 0이면, 노이즈의 전력 스펙트럼은 없어지며, Wiener 필터는 역필터가 된다.
많은 척도들이 노이즈와 열화되지 않은 영상의 전력 스펙트럼에 기반한다. 이 중 주파수 도메인의 수량을 이용해서 근사화되는 신호 대 노이즈 비(SNR)는 가장 중요한 척도 중 하나이다.
이 비율은 노이즈 전력 레벨에 대한 정보를 지닌 신호 전력(= 열화 되지 않은 영상) 레벨의 척도를 제공한다.
낮은 노이즈를 가진 영상은 높은 SNR을 갖고, 그 반대로 노이즈 레벨이 높아지면 SNR이 낮아진다.
이 비율은 복원 알고리즘의 성능을 징짓는 데 사용되는 중요한 측정 기준이다.
원본 영상과 추정 영상이 가까울수록, SNR은 더 커진다.
때로는 이 측정치들의 제곱근이 사용되는데, 이를 rms 신호 대 노이즈 비와 rms 오차라고 한다.
스펙트럼 상 백색인 노이즈를 다루면, 스펙트럼은 상수가 되어 일이 상당히 단순해진다.
그러나, 열화되지 않은 영상의 전력 스펙트럼은 좀처럼 알기 어렵다. 이 수량들을 모르거나 추정할 수 없다면, 근사화하여 접근한다.
열화 함수에 대한 적당한 추정이 가능하다면, 역필터링 보다 Wiener 필터링이 더 좋은 결과를 낸다.

[5.9 제한된 최소 제곱 필터링]
Wiener 필터에서는 열화 함수에 대해 어떤 것을 알아야 하는 문제에 더불어, 열화되지 않은 영상과 노이즈의 전력 스펙트럼을 알아야 한다는 문제가 존재한다.
앞서 전력 스펙트럼에 대한 근사로 좋은 결과를 보여줬지만, 전력 스펙트럼의 비에 대한 상수 추정이 항상 해결책이 되는 것은 아니다.
노이즈의 민감성 문제를 경감시키는 한 방법은 복원의 최적성을 영상의 2차 미분(Ex. Laplacian)과 같은 평활성의 척도에 기반하는 것이다.
복원이 의미가 있으려면, 주어진 문제의 파라미터에 의해 제한되어야 한다.
수작업으로 파라미터를 조정해가며 원본 영상에 대한 추정 영상을 복원할 때는 제한된 최소 제곱 필터가 Wiener 필터보다 성능이 더 좋을 수 있다.
노이즈의 평균과 분산에 대한 지식만으로 최적 복원 알고리즘을 구현할 수 있다. 하지만 만약 파라미터를 잘못 추정한다면 결과가 상당히 흐려 보일 것이다.
열화와 노이즈의 성질과 크기에 따라, 최적 추정을 반복적으로 계산하기 위한 알고리즘의 나머지 다른 파라미터 또한 최종 결과에 중요한 역할을 한다.
자동으로 계산된 복원 필터는 필터 파라미터를 수작업한 결과보다 성능이 떨어질 수 있는데, 이는 단일 스칼라 파라미터로 완전히 규정되는 제한된 최소 제곱 필터에 대해 특히 그렇다.

[5.10 기하 평균 필터]
Wiener 필터를 일반화하게 되면 기하 평균 필터의 형태가 된다.
알파 값이 1이면 역필터, 0이면 파라미터형 Wiener 필터가 되며 베타까지 1이면 표준 Wiener 필터가 된다.
알파가 1/2이면 필터는 같은 거듭제곱의 두 값의 곱이 된다.
베타가 1일 때, 알파ㅏ 1/2보다 커지면 역필터, 작아지면 Wiener 필터에 가까워진다.
알파가 1/2이고 베타가 1이면 스펙트럼 평활화 필터라고 불린다.
즉, 기하 평균 필터는 여러 개의 필터를 하나로 표현할 수 있기에 복원 필터를 구현할 때 매우 유용하다.

[5.11 투영에 의한 영상 재구성]
[5.11.1 서론]
재구성문제는 원리적으로 간단하므로 직접적이고 직관적인 방식을 정석적인 설명이 가능하다.
검출된 신호를 다시 투영하는 걸, 영역을 거꾸로 거치게 되므로 오염(smear)시키는 것이라고 부른다. 이러한 방법을 역투영이라고 한다.
수직, 수평, 대각 등 투영 각도를 조절하여 다양한 방면에서 투영된 1차원 신호를 역투영 시킴으로써 객체 모양에 대한 2차원 영상을 얻을 수 있다.
투영의 수가 증가되면, 교차하지 않는 역투영의 강도는 다중 역투영들이 교차하는 영역의 강도에 비해 상대적으로 감소한다.
최종적으로 더 밝은 영역들이 결과에 강하게 나타나고, 표시를 위해 영상을 스케일링 하면 교차가 드물거나 없는 투영들은 배경으로 사라진다.
투영 각도의 수가 증가면, 후광(halo)의 모양은 점진적으로 흐려지며 원형이 된다.
[5.11.2 컴퓨터 단층 촬용(CT)의 원리]
목표는 여러 방향에서 객체의 X-선 사진을 찍어서 객체의 내부 구조에 대하 3-D 표현을 얻는 것이다.
X-선 판에서는 영상에서 한 점의 밝기가 피사체를 통과한 후, 그 점에 부딪치는 X-선 에너지에 비례하는 영상이 만들어진다. 이 영상이 역투영 영상과 같다.
여러 투영 각도로 얻어진 이러한 영상들을 다시 역투영하는 과정을 반복하여 3-D 입체를 만드는 것이다.
평행광선을 따라 2-D 객체를 투영하는 방법을 Radon 변환이라 부른다.
[5.11.3 투영과 Radon 변환]
X-선 CT와 동일한 기초 원리로 SPECT, PET, MRI 같은 형식들과 일부 초음파 영상화 형식에도 적용 가능하다.
팽행-광선 빔의 투영은 데카르트 좌표게에서의 직선들의 집합으로 모델링될 수 있다. 즉, 투영 신호의 임의의 점은 선을 따라서 광선-합으로 주어진다.
Radon 변환은 투영으로부터의 재구성의 초석이며, CT가 그 영상 처리 분야에서의 주요 응용 분야이다.
Radon 변환은 직선 좌표들로 하는 영상으로 표시될 때, 그 결과를 시노그램(sinogram)이라 부르는데, 개념적으로 푸리에 스펙트럼을 표시하는 것과 비슷하다.
푸리에 변환처럼 시노그램은 영상을 재구성하는 데 필요한 데이터를 갖고있다.
시노그램은 단순한 영역에 대해서는 쉽게 해석될 수 있으나, 투영된 영역이 복잡해짐에 따라 읽기 힘들어진다.
시노그램이 영상의 중심에 대해 대칭이라면 x축과 y축에 평행한 객체를 다루고 있다는 것이다. 또한 시노그램은 부드럽게 나타는데, 이는 객체가 균일한 밝기를 가지는 것을 의미한다.
이러한 일반적인 관찰 외에는 시노그램에서 말할 수 있는 게 많지 않다.
하지만 래미노그램(laminogram)을 통해 역투영으로 만들어진 영상은 원본 영상에 대한 근사화일 뿐이라는 것을 알 수 있다.
정리하자면, Radon 변환을 통해 투영 각도들에 대한 투영을 계산하고, 이를 데카르트 좌표계로 표현한 것이 시노그램이다. 여기서 역투영을 계산하기 위해 각도를 고정하고 파라미터 값을 바꾸고, 해당 과정이 끝나면 다른 각도로 바꾸고 파라미터를 바꾸는 과정을 반복하여 래미노그램을 얻는다.
[5.11.4 푸리에-박편 정리]
1차원 푸리에 변환과 투영으로 얻어진 영역의 2차원 푸리에 변환으로 연관시키는 기초 결과를 유도한다.
푸리에-박편 정리 또는 투영-박편 정리로 알려진 이 개념은, 투영의 푸리에 변환이 투영이 얻어진 영역의 2차원 푸리에 변환의 박편임을 나타낸다.
이 방법은 2차원 변환의 역을 구하는 것이 포함되어 계산적으로 비용이 많이 든다.
[5.11.5 평햄-빔 필터링된 역투영을 이용한 재구성]
직접 역투영을 구하면 매우 흐린 결과가 나타난다. 이 문제는 역투영을 계산하기 전에 투영을 필터링하는 간단한 방법에 기반한 쉬운 해결책이 있다.
함수를 대역 제한하는 가장 간단한 방법은 주파수 도메인에서 박스를 사용하는 것이다.
박스가 원치 않는 물결 파동 현상 특성을 가지게 되면, 그 대신에 부드러운 윈도우를 사용하면 된다.
주파수 도메인의 필터링은 공가 도메인의 컨볼루션과 같기에, 물결 파동 현상이 있는 함수로 공간 필터링하면 결과 또한 물결 파동에 의해 오염된다. 부드러운 함수로 윈도잉하면 이 현상이 완화된다.
1차원 FFT 구현 시, M-점 이산 윈도우 함수에서 c = 0.54라면 해당 함수를 Hamming 윈도우라 부르고, c = 0.5인 경구는 Hann 윈도우라고 부른다.
두 윈도우 간의 차이는 후자의 끝 점들이 0이라는 것이다. 이는 일반적으로 인지하기 어렵다.
역투영된 영상은 다음과 같이 해서 얻어질 수 있다.
1. 각 투영의 1차원 푸리테 변환을 계산한다.
2. 적절한 윈도우(Ex. Hamming)에 의해 곱해진 필터 함수를 각 푸리에 변환에 곱한다.
3. 각 필터링된 변환 결과에 대해 1차우너 푸리에 역변환을 얻는다.
4. 얻은 모든 1차원 역변환을 적분한다. (더한다.)
필터 함수가 사용되기 때문에, 이 재구성 접근법을 필터링된 역투영이라는 이름으로 부른다.
실제로는 데이터가 이산적이라 모든 주파수 도메인 계산은 1차원 FFT 알고리즘을 이용해서 수행되고, 필터링은 2차원 함수에 대해 구현된다.
대안적으로 컨볼루션을 이용해 공간 도메인에서 필터링을 구현할 수 있다.
샘플링 속도는 영상 처리 결과에 중요한 영향을 준다. 그렇기에 두 가지 샘플링을 고려한다.
첫 번째는 사용한 광선의 수인데, 이는 각 투영의 샘플 수를 결정한다.
두 번째는 회전 각도 증분 수인데, 재구성된 영상(의 합이 최종 영상) 수를 정한다.
램프 필터로 재구성된 영상은 시각적으로 보이는 블러링이 없다. 그러나 꼭지점 주위의 희미한 선으로 보이는 물결 파동 현상이 존재한다.
여기서 램프 필터에 Hamming 윈도우를 사용하면, 약간의 블러링은 생기지만 물결 파동 현상은 상당히 완화된다.
하지만 영상 내에 날카로운 부위가 없다면 윈도잉하지 않은 램프 필터로도 물결 파동 현상은 인지할 수 없다.
Hamming 윈도우를 사용하면 물결 파동 현상을 완화시키고, 약간의 블러링이 생기므로 영상이 부드러워진다.
기본적으로 FFT의 구현을 통해 필터링된 역투영을 구하는 것이 기초한다.
각 각도에서 개별 역투영들은 해당 투영과 램프 필터의 푸리에 역변환을 컨볼루션시켜 얻을 수 있다.
완전한 역투영된 영상은 모든 역투영된 개별 영상들을 적분(합)하여 얻어진다.
계산상의 반올림에 의한 차이를 제외하면, 컨볼루션을 이용한 결과는 FFT를 이용한 결과와 같다. 하지만 컨볼루션이 계산상 더 효과적이다.
재구성 동안, 모든 역투영된 영상들을 저장할 필요는 없다. 그 대신, 단일 실행 합은 가장 최근의 역투영된 영상으로 업데이트 된다. 이 과정이 끝나면 실행 합은 역투영들의 총합과 같다.
램프 필터는 (윈도잉이 되더라도) 주파수 도메인의 dc 항을 0으로 만들기 때문에, 각 역투영 영상은 평균값 0을 가진다. 이는 각 역투영 영상이 음과 양의 화소들을 가질 수 있음을 의미한다.
모든 역투영들을 더하여 최종 영상을 만들 때, 몇몇 음의 위치들은 양이 될 수도 있고, 평균값이 0이 안 될 수도 있다. 그러나 전형적으로 최종 영상을 음수 화소들을 가진다.
평균값이 얼마가 되어야 하는지에 대한 지식이 없을 때, 가장 간단한 접근법은 음수 값이 이 접근법에 내재해 있다는 사실을 받아들이고, 결과를 스케일링 하는 것이다.
전형적인 평균값에 대한 지식을 알 수 있을 때는, 그 값을 주파수 도메인 필터에 더할 수 있다.
이러한 방법들로 램프를 오프셋시켜서 dc 항이 0이 되는 것을 막는다.
공간 도메인에서 컨볼루션으로 작업할 때, 공간 필터(램프의 푸리에 역변환)의 끝을 잘라버리는 행위가 평균값이 0을 갖지 못하도록 하여 0으로 만드는 문제를 완전히 피하게 해준다.
[5.11.6 부채-빔 필터링된 역투영을 이용한 재구성]
부채-빔 광선은 평행-빔 영상화 기하의 광선으로 표현하기 위해 사용된 접근법인 표준 형태의 선으로 표현될 수 있다.
이는 평행-빔 결과들을 부채-빔 기하에 대한 대응 식을 유도하기 위한 시작점으로서 사용된다.
부채-빔의 광선 합은 같은 선을 따라서 있는 평행-빔의 광선 합과 같아야 한다.
광선 합은 선을 따라서의 모든 값들의 합이므로, 좌표계와 관계없이 주어진 광선에 대해 같아야 한다.
부채-빔 기하를 평행-빔 기하로 전환하고, 평행-빔 재구성 알고리즘을 이용하는 것을 주로 이용한다.
m번째 방사 투영의 n번째 광선은 (m+n)번째 평행 투영의 n번째 광선과 같다.
샘플링 간격이 너무 넓은 경우에는 블러링, 물결 파동 현상, 앨리어싱 인위 구조를 야기할 수 있다.
