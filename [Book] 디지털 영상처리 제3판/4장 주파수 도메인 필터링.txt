[4.1 배경]
[4.1.1 Fourier 급수와 변환의 간략한 역사]
Fourier의 공헌은 모든 주기 함수는 각기 다른주파수의 sin과 cos에 각가 다른 계수를 곱한 합으로 표현될 수 있다는 것을 제시한 것이다. 이 합을 Fourier 급수하고 부른다.
주기적이지 않은 (곡선 아래 영역은 유한) 함수들도 가중 함수로 곱해진 sin과 cos들의 적분으로 표현되 수 있다. 이 경우의 공식이 Fourier 변환이며, 그 활용도는 Fourier 급수보다 훨씬 크다.
두 표현의 공통된 중요한 특성은 Fourier 급수 또는 Fourier 변환으로 표현된 함수는 역방향 처리를 통해 정보의 손실 없이 완전히 복원될 수 있다는 것이다. 이는 "Fourier 도메인"에서 작업하고 나서 어떠한 정보의 손실 없이 함수의 원래 도메인으로 되돌릴 수 있게 하기 때문에, 이 공식들의 가장 중요한 특성 중 하나다.

[4.2 예비 개념]
[4.2.1 복소수]
C = R + jI
복소수는 실수부(R)와 허수부(I)로 나뉜다. 복소수는 가로 좌표가 실수축이고 세로 좌표가 허수축인, 기하학적으로 평면(복소 평면) 상의 점으로 볼 수 있다.
즉, 복소수 R + jI는 복소수 평면의 직각 좌표계의 점 (R, I)이다. 때때로, 복소수를 극좌표로 표현하면 편리하다. (예시, https://everyday-image-processing.tistory.com/144?category=944945)
|C|는 R과 I의 제곱의 합의 제곱근이며, 복소 평면의 원점으로부터 점 (R, I)까지 연결하는 벡터의 길이이고, θ는 벡터(원점부터 (R, I)까지 거리)와 실수축(가로축, X축) 간의 각이다. 이를 통해 복소수를 극좌표로 나타낼 수 있다.
여기에 오일러 공식을 이용하면 C = |C|e^jθ로 나타낼 수 있다.
[4.2.2 Fourier 급수]
주기 T인, 연속 변수 t에 대한 함수 f(t)는 적당한 계수를 곱한 sin과 cos의 합(선형 결합)으로 표현할 수 있다. 이는 Fourier 급수로 알려져 있다. 다음과 같은 식을 같는다. 
(https://everyday-image-processing.tistory.com/144?category=944945)
Fourier 급수에 대한 식은 sin과 cos의 확정이라는 사실은 오일러 공식을 따른다.
[4.2.3 임펄스와 그 선별 특성]
선형 시스템과 Fourier 변환 연구의 중심은 임펄스와 그 선별 특성에 대한 개념이다. t=0에 위치하는 연속 변수 t의 단위 임펄스가 기본 개념이다.
임펄스는 0인 구간에서 단위 면적과 무한 직폭을 갖는 스파이크로 볼 수 있다. 임펄스는 적분에 관한 소위 선별 특성을 갖는다.
단위 이산 임펄스는 연속 변수에서 임펄스가 동작하는 것과 같이 이산 시스템에서도 같은 목적으로 사용된다.
선별 함수는 단순히 임펄스의 위치에서 함수의 값을 산출한다는 것을 알 수 있다.
연속 임펄수와 달리, 이산 임펄스는 정상(ordinary) 함수이다.
△T 단위 간격의 무한히 많은 주기 임펄스들의 합으로 정의되는 것을 임펄스 열 s_△T(t)이다. 여기서, 임펄스들은 연속적이거나 이산적일 수 있다.
[4.2.4 단일 연속 변수 함수의 Fourier 변환]
연속 변수 t의 연속 함수 f(t)에 대한 Fourier 변환이 기본 개념이다.
Fourier 변환은 주파수가 μ의 값들로 정해지는 정현파 항들이 f(t)에 곱해져 확장된 것임을 주목해야 한다 (변수 t에 대해 적분됨). 적분 후 남은 변수는 주파수 뿐이므로, Fourier 변환 도메인을 주파수 도메인이라 한다. t는 연속 변수, 주파수 변수 μ의 단위는 t의 단위에 따라 달라진다.
t가 초 단위 시간을 나타내면, μ는 사이클/초 또는 Hz가 된다. t가 M(미터)로 길이를 나타내면 μ는 사이클/미터와 같이 된다.
정리하자면, 주파수 도메인의 단위는 입력 함수의 독립변수의 단위당 사이클이 된다.
일반적으로, Fourier 변환은 복소수 항을 포함하므로, 시각화를 위해서는 변환의 크기(실수값)로만 작업하는 것이 관례다. 이를 Fourier 스펙트럼 또는 주파수 스펙트럼이라 한다.
F(μ)와 |F(μ)| 모두 0의 위치는 "사각형" 함수의 폭 W에 반비례하고, 동근 돌출부(엽)의 높이는 원점으로부터 거리의 함수로 감소하고, 스펙트럼 함수는 μ의 양과 음의 방향으로 무한히 확장한다.
공간 도메인의 원점에 위치한 임펄스의 Fourier 변환은 주파수 도메인에서 상수가 된다.
주기 △T인 임펄스 열의 Fourier 변환은 주기 1/△T인 임펄스 열이라는 사실을 보여준다.
[4.2.5 컨볼루션]
두 함수의 컨볼루션은 원점에 대해 한 함수를 반전(180도 회전)시킨 후 다른 함수의 위로 슬라이딩시켜 구한다는 것이다.
슬라이딩 과정에서 각 이동마다 계산을 수행하는데, 이전에는 곱의 합이었다. 여기서는 한 연속변수 t에 대한 f(t)와 h(t)의 컨볼루션에 합산 대신 적분을 사용한다.
(공식,https://everyday-image-processing.tistory.com/146?category=944945)
음수 부호는 반전을 의미하고, t는 다른 함수를 지나 한 함수를 슬라이딩 시키는데 필요한 변위(이동거리)이며, τ는 적분에 사용되는 부가 변수이다. 함수들은 -∞ ~ ∞까지 범위는 갖는다고 가정한다.
H(μ)는 h(t)의 Fourier 변환이다.
t의 도메인은 공간 도메인, μ의 도메인은 주파수 도메인이라 했다. 공간 도메인에서 두 함수의 컨볼루션에 대한 Fourier 변환이 그 두 함수의 Fourier 변환을 주파수 도메인에서 곱한것과 동등하다는 것을 알 수 있다.
역으로, 두 변환의 곱이 주어지면, Fourier 역변환을 계산함으로써 공간 도메인의 컨볼루션을 구할 수 있다.
이는 주파수 도메인의 컨볼루션이 공간 도메인에서의 곱과 동등하다는 것을 의미한다.
이를 컨볼루션 정리라고 부르며, 이들은 각각 정방향과 역방향 Fourier 변환에 관련되어 있다. 이는 주파수 도메인 필터링의 기초가 된다.

[4.3 샘플링과 샘플링된 함수의 Fourier 변환]
[4.3.1 샘플링]
연속 함수는 컴퓨터에서 처리되기 전에 이산 값들의 시퀀스로 변환되어야 한다.
독립 변수 t에 대해 등간격 △T로 샘플링하려는 연속 함수 f(t)는 -∞ ~ ∞까지 범위는 갖는다고 가정한다.
샘플링을 모델링하는 방법은 f(t)에 △T 단위 간격의 임펄스 열과 같은 샘플링 함수를 곱하는 것이다.
이 합(결과)의 각 성분은 임펄스의 위치에서 f(t) 값으로 가중된 임펄스이다.
각 샘플의 값은 가중치로 곱해진 임펄스의 세기(strength)로서 적분은 통해 구해진다.
[4.3.2 샘플링된 함수의 Fourier 변환]
F(μ)는 연속 함수 f(t)의 Fourier 변환을 나타낸다고 한다. 대응되는 샘플링된 함수는 f(t)와 힘플스 열의 곱이다.
또한 앞서 공간 도메인에서 두 함수의 곱에 대한 Fourier 변환은 주파수 도메인에서 두 함수의 변환에 대한 컨볼루션이라는 사실을 알고 있다.
샘플링된 함수의 Fourier 변환은 F(μ) 복사본을 반복한 무한 주기 시퀀스가 된다. F(μ)는 원래 함수의 반환이며 연속 함수이다. 복사본들간 간격은 1/△T의 값에 의해 결정된다. (△T(샘플링 속도))
오버 샘플링되면 그래프 상에서 X축 아래로 내려가기에 연속되지 않고, 임계 샘플링은 최소값이 0이며, 언더 샘필링의 경우 모든 값이 X축보다 위에 존재한다.
[4.3.3 샘플링 정리]
샘플링 처리를 수식적으로 고찰, 연속 함수가 샘플들의 집합으로부터 유일하게 복원될 수 있는 조건 세워보자.
Fourier 변환이 원점을 기준으로 유한 구간 바깥의 주파수 값에 대해서는 0인 함수 f(t)를 대역 제한된 함수라고 부른다.
샘플링된 함수의 변환에 포함된 함수의 주기적 복사본 시퀀스로부터 F(μ)의 복사본을 분리할 수 있다면, 샘플링된 버전으로부터 f(t)를 복원할 수 있다. 이는 Fourier 역변환을 이용하여 그 단일 주기로부터 f(t)를 복구할 수 있다는 것을 의미한다.
복사본들이 서로 충분히 분리되어 있다면 F(μ)의 역함수로부터 F(μ)와 동등한단일 주기를 추출하는 것이 가능하다. 1/2△T > μ_max 를 만족한다면 충분한 분리가 보장된다.
이 식은 연속이고 대역 제한된 함수가 갖는 최고 주파스의 두 배를 초과하는 속도로 샘플들이 얻어지면, 그 샘플들로부터 완전하게 복원될 수 있다는 것을 나타낸다. 이 결과는 "샘플링 정리"로 알려져 있다.
이 결과로부터, 연속이고 대역 제한된 함수가 갖는 최고 주파수의 두 배보다 큰 속도로 얻어진 샘플들로 표현된다면, 정보의 손실이 없다고 말할 수 있다.
역으로, 1/△T 속도로 신호를 샘플링하여 포착될 수 있는 최대 주파수는 1/2△T라고 할 수 있다.
Nyquist 속도로 샘플링하면 때때로 완전한 함수 복원이 충분하지만, 샘플링이 Nyquist 속도를 넘어야 한다는 것을 명시하고 있는 것이다.
F(μ)를 구하고 나면 Fourier 역변환을 이용해서 f(t)를 복원할 수 있다.
이론저으로 함수가 갖는 최대 주파수의 두 배를 초과하는 속도로 샘플링하여 얻은 샘플들로부터 대역 제한된함수를 복원하는 것이 가능하다는 것을 증명 가능하다.
f(t)가 대역 제한되어야 한다는 요구 조건은 실제로는 충족될 수 없는 조건인 -∞ ~ ∞까지 f(t)가 확장되어야 함을 일반적으로 의미한다.
함수의 구간을 제한해야 한다는 것은 일부 특수한 경우를 제외하고는 함수의 완전한 복원을 막는다.
함수 H(μ)는 주파수 범위에서 하한에 위치한 주파수들을 통과시키지만 나머지 높은 주파수들은 모두 제거(필터링)하기 때문에 저역통과 필터라 부른다.
무한히 빠른 진폭 천이 때문에 이상적 저역통과 필터라 부른다.
샘플들로부터 원래 함수를 복원하는 도구가 되므로, 앞선 목적으로 사용되는 필터를 복원 필터라 부른다.
[4.3.4 앨리어싱]
"대역 제한된 함수를 그 최대 주파수의 두 배 보다 낮은 속도로 샘플링하면 어떤 일이 발생하는가?" >> 언더-샘플링의 경우
Nyquist 속도 아래로 샘플링 속도를 낮추면 그 전체 효과는 주기들이 겹치게 되어 사용된 필터와 무관하게, 변환된 함수의 한 주기를 분리할 수 없게 되는 것이다.
함수를 언더-샘플링하여 생기는 효과는 주파수 앨리어싱 또는 앨리어싱이라고 알려져 있다.
앨리어싱은 연속 함수의 높은 주파수 성분들이, 샘플링된 함수에서 더 낮은 주파수로 "가장"하는 현상이다.
이것은 가짜라는 의미로 통상 사용하는 용어인 앨리어스와 일관된다.
앨리어싱은 샘플링된 신호에 항상 존재한다. 원래 샘플링된 함수가 대역 제한 되어 있더라도, 함수의 구간을 제한하는 순간 무한 주파수 성분이 발생하기 때문이다. 이때 함수 구간의 제한은 실제 문제에서는 항상 해야 하는 것이다.
H(μ)는 무한한 범위까지 주파수 성분을 갖는다. H(μ)와 컨볼루션을 취하면 주파수 성분이 무한 범위로 확장된 결과를 얻는다. 그러므로 유한 구간을 갖는 어떠한 함수도 대역 제한될 수 없다. 대역 제한된 함수는 반드시 -∞ ~ ∞까지 범위가 확장된다.
앨리어싱은 유한 길이를 갖는 샘플링된 기록물에 대해 작업할 때 피할 수 없다.
실제 앨리어싱 효과는 입력 함수를 스무딩하여 고주파를 감쇠시켜 줄일 수 있다. 안티-앨리어싱이라 불리는 이 과정은 함수가 샘플링되기 전에 수행되어야 한다. 앨리어싱은 계산 기법으로 "사후 취소"될 수 없는 샘플링 문제이기 때문이다.
[4.3.5 샘플링된 데이터로부터의 함수 복원]
샘플들로부터의 함수 복원은 실제로는 샘플들 간의 보간하는 것이다.
영상을 시각화하는 간단한 것 조차도 시각화 매체에서 그 샘플들로부터 영상을 복원해야 한다.
사각형 필터 H(μ)의 Fourier 역변환이 sinc 함수이다.
완전하게 복원된 함수는 샘플 값들이 가중치로 곱해진 sinc 함수들의 무한합이며, 복원된 함수는 △T의 정수배 위치에서 샘플 값과 똑같다는 중요한 성질을 가짐을 보여준다.
즉, 가 정수인 모든 t = k△T에 대해 f(t)는 k번째 샘플 f(k△T)와 같다. sinc(0) = 1이고, 그 이외의 정수 m에 대해서 sinc(m) = 0이기 때문이다. 샘플 점들 사이에서, f(t)의 값들은 sinc 함수들의 합에 의해 보간된 것이다.
영상 처리에 사용되는 주요 보간법은 최근접 이웃, 쌍일차, 쌍삼차 보간이다.

[4.4 단일 변수 함수의 이산 Fourier 변환(DFT)]
[4.4.1 샘플링된 함수의 연속적 변환으로부터 DFT 얻기]
-∞ ~ ∞까지 확장된 샘플링 대역 제한된 함수의 Fourier 변환도 -∞ ~ ∞까지 확장된 연속 주기 함수이다.
실제로는 유한 개의 샘플로 작업하므로 그러한 샘플 집합에 해당되는 DFT를 유도한다.
f_n은 이산 함수이지만 그 Fourier 변환인 F(μ)(연속, 주기 = 1/△T, 무한히 반복)의 역함수를 특징짓는 데 필요한 모든 것은 한 주기이며, 한 주기를 샘플링하는 것이 DFT 기초이다.